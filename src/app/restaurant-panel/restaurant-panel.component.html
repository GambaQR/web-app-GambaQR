<div
  class="min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white"
>
  <div class="bg-white/50 dark:bg-gray-800/40 backdrop-blur-xl shadow-sm p-4">
    <div
      class="max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between gap-4"
    >
      <div class="flex items-center gap-4">
        <a routerLink="/">
          <button
            class="flex items-center justify-center p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="h-5 w-5 text-gray-600 dark:text-gray-400"
            >
              <path d="m12 19-7-7 7-7"></path>
              <path d="M19 12H5"></path>
            </svg>
          </button>
        </a>
        <div>
          <h1 class="text-2xl font-bold">Panel de Restaurante</h1>
        </div>
      </div>
      <div
        class="flex flex-wrap items-center justify-center md:justify-end gap-2"
      >
        <a routerLink="/menu">
          <button
            class="inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="h-4 w-4 mr-2"
            >
              <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
              <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h6z"></path>
            </svg>
            Ver Menú
          </button>
        </a>
        <a routerLink="/restaurant/qr-generator">
          <button
            class="inline-flex items-center px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-900 dark:text-white font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="h-4 w-4 mr-2"
            >
              <rect width="5" height="5" x="3" y="3" rx="1" />
              <rect width="5" height="5" x="16" y="3" rx="1" />
              <rect width="5" height="5" x="3" y="16" rx="1" />
              <path d="M21 16h-3a2 2 0 0 0-2 2v3" />
              <path d="M21 21v.01" />
              <path d="M12 7v3a2 2 0 0 1-2 2H7" />
              <path d="M3 12h.01" />
              <path d="M12 3h.01" />
              <path d="M12 16v.01" />
              <path d="M16 12h1" />
              <path d="M21 12v.01" />
              <path d="M12 21v-1" />
            </svg>
            Generar QR
          </button>
        </a>
      </div>
    </div>
  </div>

  <div class="max-w-7xl mx-auto p-6">
    <div class="space-y-6">
      <div
        class="grid w-full grid-cols-3 bg-gray-100 dark:bg-gray-700 rounded-lg p-1 text-gray-900 dark:text-white"
      >
        <button
          (click)="setActiveTab('dashboard')"
          [ngClass]="{
            'bg-white dark:bg-purple-800 text-purple-600 dark:text-white shadow':
              activeTab === 'dashboard',
            'hover:bg-gray-200 dark:hover:bg-gray-600':
              activeTab !== 'dashboard'
          }"
          class="py-2 px-4 rounded-md text-sm font-medium transition-colors"
        >
          Dashboard
        </button>
        <button
          (click)="setActiveTab('orders')"
          [ngClass]="{
            'bg-white dark:bg-purple-800 text-purple-600 dark:text-white shadow':
              activeTab === 'orders',
            'hover:bg-gray-200 dark:hover:bg-gray-600': activeTab !== 'orders'
          }"
          class="py-2 px-4 rounded-md text-sm font-medium transition-colors"
        >
          Pedidos
        </button>
        <button
          (click)="setActiveTab('menu')"
          [ngClass]="{
            'bg-white dark:bg-purple-800 text-purple-600 dark:text-white shadow':
              activeTab === 'menu',
            'hover:bg-gray-200 dark:hover:bg-gray-600': activeTab !== 'menu'
          }"
          class="py-2 px-4 rounded-md text-sm font-medium transition-colors"
        >
          Menú
        </button>
      </div>

      <div *ngIf="activeTab === 'dashboard'" class="space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <div
            class="bg-white/50 dark:bg-gray-800/40 backdrop-blur-xl rounded-xl shadow-md p-4"
          >
            <div
              class="flex flex-row items-center justify-between space-y-0 pb-2"
            >
              <h3 class="text-sm font-medium text-gray-600 dark:text-gray-400">
                Pedidos Hoy
              </h3>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="h-4 w-4 text-gray-500 dark:text-gray-500"
              >
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
            </div>
            <div class="pb-2">
              <div class="text-2xl font-bold text-gray-900 dark:text-white">
                {{ todayStats.totalOrders }}
              </div>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                +12% desde ayer
              </p>
            </div>
          </div>

          <div
            class="bg-white/50 dark:bg-gray-800/40 backdrop-blur-xl rounded-xl shadow-md p-4"
          >
            <div
              class="flex flex-row items-center justify-between space-y-0 pb-2"
            >
              <h3 class="text-sm font-medium text-gray-600 dark:text-gray-400">
                Ingresos
              </h3>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="h-4 w-4 text-gray-500 dark:text-gray-500"
              >
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path
                  d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"
                ></path>
              </svg>
            </div>
            <div class="pb-2">
              <div class="text-2xl font-bold text-gray-900 dark:text-white">
                ${{ todayStats.revenue | number : "1.2-2" }}
              </div>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                +8% desde ayer
              </p>
            </div>
          </div>

          <div
            class="bg-white/50 dark:bg-gray-800/40 backdrop-blur-xl rounded-xl shadow-md p-4"
          >
            <div
              class="flex flex-row items-center justify-between space-y-0 pb-2"
            >
              <h3 class="text-sm font-medium text-gray-600 dark:text-gray-400">
                Valor Promedio
              </h3>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="h-4 w-4 text-gray-500 dark:text-gray-500"
              >
                <polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline>
                <polyline points="16 7 22 7 22 13"></polyline>
              </svg>
            </div>
            <div class="pb-2">
              <div class="text-2xl font-bold text-gray-900 dark:text-white">
                ${{ todayStats.avgOrderValue | number : "1.2-2" }}
              </div>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                +3% desde ayer
              </p>
            </div>
          </div>

          <div
            class="bg-white/50 dark:bg-gray-800/40 backdrop-blur-xl rounded-xl shadow-md p-4"
          >
            <div
              class="flex flex-row items-center justify-between space-y-0 pb-2"
            >
              <h3 class="text-sm font-medium text-gray-600 dark:text-gray-400">
                Clientes Activos
              </h3>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="h-4 w-4 text-gray-500 dark:text-gray-500"
              >
                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="8.5" cy="7" r="4"></circle>
                <path d="M20 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path>
                <circle cx="15.5" cy="7" r="4"></circle>
              </svg>
            </div>
            <div class="pb-2">
              <div class="text-2xl font-bold text-gray-900 dark:text-white">
                {{ todayStats.activeCustomers }}
              </div>
              <p class="text-xs text-gray-600 dark:text-gray-400">
                En el restaurante
              </p>
            </div>
          </div>
        </div>

        <div
          class="bg-white/50 dark:bg-gray-800/40 backdrop-blur-xl rounded-xl shadow-md p-4"
        >
          <h2 class="text-lg font-bold text-gray-900 dark:text-white mb-4">
            Pedidos Recientes
          </h2>
          <div class="space-y-4">
            <ng-container *ngIf="orders.length === 0">
              <p class="text-gray-500 dark:text-gray-400 text-center py-4">
                No hay pedidos recientes.
              </p>
            </ng-container>
            <ng-container *ngFor="let order of orders.slice(0, 5)">
              <div
                class="flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 border border-gray-200 dark:border-gray-700 rounded-lg"
              >
                <div class="flex-1 mb-2 sm:mb-0">
                  <div class="flex items-center gap-3 mb-1">
                    <span class="font-medium text-gray-900 dark:text-white">{{
                      order.id
                    }}</span>
                    <span
                      [ngClass]="getStatusColor(order.status)"
                      class="px-2.5 py-0.5 rounded-full text-xs font-medium"
                      >{{ getStatusText(order.status) }}</span
                    >
                    <span class="text-sm text-gray-500 dark:text-gray-400">{{
                      order.table
                    }}</span>
                  </div>
                  <p class="text-sm text-gray-600 dark:text-gray-300">
                    {{ order.items.join(", ") }}
                  </p>
                  <p class="text-sm text-gray-500 dark:text-gray-400">
                    {{ order.customer }} - {{ order.time }}
                  </p>
                </div>
                <div class="text-right flex-shrink-0">
                  <p class="font-bold text-lg text-gray-900 dark:text-white">
                    ${{ order.total | number : "1.2-2" }}
                  </p>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </div>

      <div *ngIf="activeTab === 'orders'" class="space-y-6">
        <h2 class="text-xl font-bold text-gray-900 dark:text-white">
          Todos los Pedidos
        </h2>
        <div class="grid gap-6">
          <ng-container *ngIf="orders.length === 0">
            <p class="text-gray-500 dark:text-gray-400 text-center py-4">
              No hay pedidos registrados.
            </p>
          </ng-container>
          <ng-container *ngFor="let order of orders">
            <div
              class="bg-white/50 dark:bg-gray-800/40 backdrop-blur-xl rounded-xl shadow-md p-4"
            >
              <div
                class="pb-3 border-b border-gray-200 dark:border-gray-700 mb-4"
              >
                <div class="flex items-center justify-between mb-1">
                  <div class="flex items-center gap-3">
                    <h3 class="text-lg font-bold">{{ order.id }}</h3>
                    <span
                      [ngClass]="getStatusColor(order.status)"
                      class="px-2.5 py-0.5 rounded-full text-xs font-medium"
                      >{{ getStatusText(order.status) }}</span
                    >
                  </div>
                  <div class="text-right">
                    <p class="font-bold text-lg text-gray-900 dark:text-white">
                      ${{ order.total | number : "1.2-2" }}
                    </p>
                    <p class="text-sm text-gray-500 dark:text-gray-400">
                      {{ order.time }}
                    </p>
                  </div>
                </div>
                <p class="font-medium text-gray-900 dark:text-white">
                  {{ order.table }} - {{ order.customer }}
                </p>
                <div class="mt-2 text-gray-600 dark:text-gray-300 space-y-1">
                  <p
                    *ngFor="let item of order.items; let i = index"
                    class="text-sm"
                  >
                    • {{ item }}
                  </p>
                </div>
              </div>
              <div class="flex flex-wrap gap-2 justify-end">
                <ng-container *ngIf="order.status === 'pending'">
                  <button
                    class="inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"
                    (click)="updateOrderStatus(order.id, 'preparing')"
                  >
                    Iniciar Preparación
                  </button>
                </ng-container>
                <ng-container *ngIf="order.status === 'preparing'">
                  <button
                    class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"
                    (click)="updateOrderStatus(order.id, 'ready')"
                  >
                    Marcar como Listo
                  </button>
                </ng-container>
                <ng-container *ngIf="order.status === 'ready'">
                  <button
                    class="inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
                    (click)="updateOrderStatus(order.id, 'delivered')"
                  >
                    Marcar como Entregado
                  </button>
                </ng-container>
              </div>
            </div>
          </ng-container>
        </div>
      </div>

      <div *ngIf="activeTab === 'menu'" class="space-y-6">
        <h2 class="text-xl font-bold text-gray-900 dark:text-white">
          Gestión de Menú
        </h2>
        <div
          class="grid w-full grid-cols-2 bg-gray-100 dark:bg-gray-700 rounded-lg p-1 text-gray-900 dark:text-white"
        >
          <button
            (click)="setActiveMenuTab('categories')"
            [ngClass]="{
              'bg-white dark:bg-purple-800 text-purple-600 dark:text-white shadow':
                activeMenuTab === 'categories',
              'hover:bg-gray-200 dark:hover:bg-gray-600':
                activeMenuTab !== 'categories'
            }"
            class="py-2 px-4 rounded-md text-sm font-medium transition-colors"
          >
            Categorías
          </button>
          <button
            (click)="setActiveMenuTab('products')"
            [ngClass]="{
              'bg-white dark:bg-purple-800 text-purple-600 dark:text-white shadow':
                activeMenuTab === 'products',
              'hover:bg-gray-200 dark:hover:bg-gray-600':
                activeMenuTab !== 'products'
            }"
            class="py-2 px-4 rounded-md text-sm font-medium transition-colors"
          >
            Productos
          </button>
        </div>

        <div *ngIf="activeMenuTab === 'categories'" class="space-y-6">
          <div class="flex justify-end">
            <button
              (click)="handleAddCategory()"
              class="inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="h-4 w-4 mr-2"
              >
                <path d="M5 12h14"></path>
                <path d="M12 5v14"></path>
              </svg>
              Nueva Categoría
            </button>
          </div>
          <app-category-manager
            [categories]="menuCategories"
            (onEdit)="handleEditCategory($event)"
            (onDelete)="handleDeleteCategory($event)"
            (onToggleStatus)="handleToggleCategoryStatus($event)"
          ></app-category-manager>
        </div>

        <div *ngIf="activeMenuTab === 'products'" class="space-y-6">
          <div class="flex justify-end">
            <button
              (click)="handleAddProduct()"
              class="inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="h-4 w-4 mr-2"
              >
                <path d="M5 12h14"></path>
                <path d="M12 5v14"></path>
              </svg>
              Nuevo Producto
            </button>
          </div>
          <app-product-manager
            [products]="menuProducts"
            [categories]="menuCategories"
            (onEdit)="handleEditProduct($event)"
            (onDelete)="handleDeleteProduct($event)"
            (onToggleStatus)="handleToggleProductStatus($event)"
            (onToggleAvailability)="handleToggleProductAvailability($event)"
          ></app-product-manager>
        </div>
      </div>
    </div>
  </div>

  <!-- Modals -->

  <app-overlay
    [isOpen]="showCategoryForm"
    (close)="onCategoryFormCancel()"
    maxWidthClass="max-w-md"
  >
    <app-category-form
      [category]="editingCategory"
      (onSave)="onCategoryFormSave($event)"
      (onCancel)="onCategoryFormCancel()"
    ></app-category-form>
  </app-overlay>

  <app-overlay
    [isOpen]="showProductForm"
    (close)="onProductFormCancel()"
    maxWidthClass="max-w-lg"
  >
    <app-product-form
      [product]="editingProduct"
      [categories]="menuCategories"
      (onSave)="onProductFormSave($event)"
      (onCancel)="onProductFormCancel()"
    ></app-product-form>
  </app-overlay>
</div>
